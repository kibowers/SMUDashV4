@model course
@{
    ViewBag.Title = "ImportCourses";
}


<!--

Known bug: modal reappears after validation. 
    
-->


@using (Html.BeginForm("ImportCourses", "Home", FormMethod.Post, new { id = "importcoursesForm", enctype = "multipart/form-data"}))
{
    <fieldset>
    </fieldset>
    <style>
        body {
            background: url(https://i.imgur.com/VtXEfl0.png);
            background-size: cover;
        }


        /**Rectangle 1 */



        .smulogo {
            position: absolute;
            width: 350px;
            height: 125px;
            left: 0px;
            top: 0px;
            background: url(https://i.imgur.com/4IpDWG0.png);
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
        }

        #rect1 {
            position: absolute;
            width: 2240px;
            height: 125px;
            left: 350px;
            top: 0px;
            background: #151C55;
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
        }

        #notice {
            background: #151C55;
            border: 1px solid #8A704C;
            box-sizing: border-box;
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25), 0px 4px 4px rgba(0, 0, 0, 0.25);
        }

        .evalConfirm -_body {
            margin: -70px 0 30px;
        }


        .evalConfirm ._body ._box {
            margin: auto;
            max-width: 80%;
            padding: 50px;
            background: white;
            border-radius: 3px;
            box-shadow: 0 0 35px rgba(10, 10, 10,0.12);
            -moz-box-shadow: 0 0 35px rgba(10, 10, 10,0.12);
            -webkit-box-shadow: 0 0 35px rgba(10, 10, 10,0.12);
        }

        #linker {
            border: 1px solid #8A704C;
            background: #8A704C;
            color: #fff;
            padding: 20px;
            cursor: pointer;
            -webkit-border-radius: 4px;
        }

        #selectopts {
            z-index: 1;
            background: #151C55;
            margin-left: 500px;
            position: absolute;
            width: 195px;
            height: 35px;
            left: 1245px;
            top: 48px;
        }

        #dropdownMenuButton {
            background: #151C55;
        }

        #rect2 {
            position: center;
            width: 1100px;
            height: 900px;
            left: 244px;
            top: 194px;
            background: #DCBDA0;
            border: 1px solid #8A704C;
            box-sizing: border-box;
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25), 0px 4px 4px rgba(0, 0, 0, 0.25);
        }


        #hublogo {
            position: absolute;
            width: 807px;
            height: 65px;
            left: 394px;
            top: 40px;
            font-style: normal;
            font-weight: 700;
            font-size: 36px;
            line-height: 52px;
            color: #FFFFFF;
        }



        #instruct1 {
            position: absolute;
            width: 500px;
            height: 375px;
            left: 550px;
            top: 150px;
        }
    </style>


    <html>
    <head>

        <meta name="viewport"
              content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
              rel="stylesheet" />
        <!-- MDB -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.11.0/mdb.min.css"
              rel="stylesheet" />

        <!-- MDB -->
        <script type="text/javascript"
                src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.11.0/mdb.min.js"></script>


        <script src="C:\Users\Kaleb\source\repos\WebApplication3\WebApplication3\Scripts\jquery-3.4.1.min.js"></script>
        <script src="C:\Users\Kaleb\source\repos\WebApplication3\WebApplication3\Scripts\bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-81J8R69BHH"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());

            gtag('config', 'G-81J8R69BHH');
        </script>
        <title> Import New Course </title>



        <script>

            $(window).on('load', function () {

                $('#myModal').modal({ backdrop: 'static', keyboard: false });
                $("#course1").tooltip();
                $("#course2").tooltip();
                var e1 = document.getElementById("er1").value;
                var e2 = document.getElementById("er2").value;
                var e3 = document.getElementById("er3").value;
                var e4 = document.getElementById("er4").value;

                if (e1 == 1) {
                    $('#myModal').modal('hide');


                }
                else {

                    $('#myModal').modal('show');

                }

                if (e2 == 2) {

                    $('#myModal').modal('hide');


                }
                else {

                    $('#myModal').modal('show');
                }
                if (e3 == 3) {

                    $('#myModal').modal('hide');


                }
                else {

                    $('#myModal').modal('show');
                }
                if (e4 == 3) {

                    $('#myModal').modal('hide');


                }
                else {

                    $('#myModal').modal('show');
                }
            });



            function existCourseForm() {
                $('#myModal').modal('hide');


            };

            function newCourseForm() {
                $('#myModal').modal('hide');
                document.getElementById("container1").style.visibility = "visible";
            }





        </script>





    </head>

    <body>

        <script>



        </script>
        <div class="dropdown" id="selectopts">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Login Options
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="@Url.Action("LogOutProf", "Home")">Logout</a>
                <a class="dropdown-item" href="@Url.Action("TableauPages", "Home")"> Student Analytics </a>
                <a class="dropdown-item" href="@Url.Action("ProfHub","Home")"> Professor Dashboard</a>
            </div>
        </div>

        <div class="evalConfirm">
            <div class="navbar-header">
                <div class="rect" id="rect1"> </div>
                <div class="smulogo"> </div>
                <h2 id="hublogo">  Import Courses </h2>
            </div>
        </div>


        <br />
        <br />
        <br />
        <br />

        <div class="text-center">

            <div id="myModal" class="modal center-block active" role="dialog" style="background: #151C55;">
                <br />
                <br />
                <br />
                <div class="modal-dialog">
                    <div class="modal-content" style="background-color: burlywood; font-style: normal; font-weight: 700; font-size: 20px; line-height: 24px; letter-spacing: 0.02em;">
                        <div class="modal-header">
                            <h4 class="modal-title" style="font-style: normal; font-weight: 700; font-size: 20px; line-height: 24px; letter-spacing: 0.02em;"><strong> Select Import Option </strong></h4>
                        </div>
                        <div class="modal-body">
                            <div class="text-center">
                                <p> Are you importing using an existing course or creating an entirely new course? </p>

                                <input type="button" value="Existing Course" style="font-size: 16px; border: 1px solid #000000; box-sizing: border-box; box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25), 0px 4px 4px rgba(0, 0, 0, 0.25);" onclick="location.href='@Url.Action("ImportCoursesExisting", "Home")'" id="existCourse" />
                                <input type="button" value="New Course" style="font-size: 16px; border: 1px solid #000000; box-sizing: border-box; box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25), 0px 4px 4px rgba(0, 0, 0, 0.25);" onclick="newCourseForm()" id=" newCourse" />
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>


        <section class="h-100 gradient-form ">
            <div class="container py-5 h-100" id="container1" style="visibility:hidden;">
                <div class="row d-flex justify-content-center align-items-center h-100">
                    <div class="col-xl-10">
                        <div class="card rounded-3 text-black">
                            <div class="row g-0">
                                <div class="col-lg-6">
                                    <div class="rect" id="rect2">
                                        <div class="card-body p-md-5 mx-md-4">
                                            <form enctype="multipart/form-data">
                                                @Html.AntiForgeryToken()
                                                <div class="form-outline mb-4">

                                                    <div class="container" style=" font-style: normal; font-weight: 500; font-size: 18px; line-height: 36px;">



                                                        <label id="thing1" for="course1"> Add a Course Name: </label>
                                                        <br />



                                                        @Html.TextBoxFor(a => a.CourseTitle, new
                                                        {
                                                            @type = "text",

                                                       @id = "course1",
                                                       @ariadescribedby = "courseMsg",
                                                       @name = "course1",
                                                       @placeholder = "Please enter a course title.",
                                                       @style = "text-align:center; position: absolute;",
                                                       @maxlength = "200",
                                                       @pattern = "^[a-zA-Z_ ]{4,100}?$",
                                                       @onclick = "$('.tooltip').remove();",
                                                       @title = "Course names are a 4 to 100, character only input"
                                                        })


                                                        <script>$("#course1").tooltip();</script>


                                                        <br />

                                                        <br />
                                                        @Html.ValidationMessageFor(a => a.CourseTitle)
                                                        @Html.Hidden("testvar1", "", new { @id = "testvar1", @name = "testvar1" })
                                                        <label class="errmsg" id="error1" style="padding-left: 20px; color:red;"></label>
                                                        <input id="er1" value="0" style="visibility:hidden;" />

                                                        <br />


                                                        <label id="thing2" for="course2"> Add a Course Code </label>
                                                        <br />


                                                        @Html.TextBoxFor(a => a.CourseCode, new
                                                        {
                                                            @type = "text",
                                                      
                                                       @id = "course2",
                                                       @ariadescribedby = "coursecodeMsg",
                                                       @name = "course2",
                                                       @placeholder = "Please enter a course code.",
                                                       @pattern = "^([a-zA-Z]{3,4})+([+-]?)+(?=\\.\\d|\\d)(?:\\d+)?(?:\\.?\\d*)(?:[eE]([+-]?\\d+))?$",
                                                       @title = "Course codes should be three to four characters, followed by a dash -, followed by exactly four numbers.",
                                                       @onclick = "$('.tooltip').remove();",
                                                       @style = "text-align:center; position: absolute;",
                                                       @maxlength = "9"
                                                        })
                                                        <br />
                                                        @Html.ValidationMessageFor(a => a.CourseCode)
                                                        @Html.Hidden("testvar2", "", new { @id = "testvar2", @name = "testvar2" })
                                                        <script>$("#course2").tooltip();</script>

                                                        <label class="errmsg" id="error2" style="padding-left: 20px; color:red;"></label>
                                                        <input id="er2" value="0" style="visibility:hidden;" />

                                                        <!-- Html year selector via range: validation implemented so it only allows selections two years in advance-->


                                                        <br />

                                                        <a href="~/Uploads/samplecsv.csv"><img src="https://i.imgur.com/xS5uWF0.png" id="instruct1" />  </a>



                                                        <label for="courseYear"> Select Course Year </label>
                                                        <input name="courseYear"
                                                               required
                                                               onclick="$('.tooltip').remove();"
                                                               type="range"
                                                               id="courseYear"
                                                               title="Please provide the year the created course will be offered."
                                                               oninput="document.getElementById('l1').innerHTML = this.value" />
                                                        <!-- year auto update-->
                                                        <label id="l1" style="padding-left:20px"> </label>
                                                        <label class="errmsg" id="error3" style="padding-left: 20px; color:red;"></label>
                                                        <input id="er3" value="0" style="visibility:hidden;" />
                                                        <script>$("#courseYear").tooltip();</script>
                                                        <br />


                                                        <label for="cTerm" id="thing4"> Select Course Term </label>
                                                        <br />

                                                        <select id="cTerm" onclick="$('.tooltip').remove();" title="Please provide the year the created course will be offered." required>
                                                            <option value="0"> Select a course term. </option>
                                                            <option value="1"> Term 1  </option>
                                                            <option value="2"> Term 2  </option>
                                                            <option value="3A"> Term 3A  </option>
                                                            <option value="3B"> Term 3B  </option>
                                                        </select>
                                                        <input type="hidden" class="hiddenthing" value="" id="hiddenInfo" name="hiddenInfo" />
                                                        <br />
                                                        <label class="errmsg" id="error4" style="padding-left: 20px; color:red;"></label>
                                                        <input id="er4" value="0" style="visibility:hidden;" />
                                                        <script>$("#cTerm").tooltip();</script>
                                                        <br />

                                                        <label for="file"> Import Student List from CSV  </label>


                                                        <input type="file"
                                                               required
                                                               onclick="$('.tooltip').remove();"
                                                               title="Please provide a .CSV file with the list of students within your course."
                                                               id="file"
                                                               name="file"
                                                               accept=".csv" />
                                                        <script>$("#file").tooltip();</script>
                                                        <!-- potential "All" issue? -->
                                                        <br />
                                                        <input type="submit" name="submit" id="createsubmit" value="Create New Course" style="position: center; width: 262px; height: 37px; left: 308px; top: 715px; font-style: normal; font-weight: 700; font-size: 20px; line-height: 29px; /* identical to box height */ text-align: center; background: #151C55; color: antiquewhite;" />
                                                        @ViewBag.Message

                                                    </div>
                                                </div>

                                            </form>
                                        </div>
                                    </div>

                                </div>


                            </div>

                        </div>

                    </div>

                </div>


            </div>






        </section>

        <script>




            //automatically set course year on load so as to futureproof application
            $(window).on('load', function () {
                var currYear = new Date().getFullYear();
                var nextYear = new Date().getFullYear() + 1;
                var nextnextYear = new Date().getFullYear() + 2;
                var inputgrabber = document.getElementById('courseYear');
                inputgrabber.setAttribute("min", currYear);
                inputgrabber.setAttribute("max", nextYear);
                inputgrabber.setAttribute("value", currYear);



                inputgrabber.setAttribute("step", 1);

                document.getElementById('l1').innerHTML = inputgrabber.value;

            });

            function getOption() {
                selectElement = document.querySelector('#cTerm');
                hiddenthing = selectElement.value;
                document.querySelector('.hiddenthing').value = hiddenthing;
                alert("Course term selected. ");
                $("#cTerm").prop('disabled', true);
            };



            $(document).on('change', '#cTerm', function () {
                getOption();

                $("#cTerm").prop('disabled', true);
            });

            $('#importcoursesForm').on('submit', function (e) {

                var dataisValid = false;
                selectElement = document.getElementById("course1").value.length; //getting course title
                hiddenthing1 = selectElement;
                $('#testvar1').val(hiddenthing1);

                 selectElement2 = document.getElementById("course2").value.length; //getting course code
                hiddenthing2 = selectElement2;
                $('#testvar2').val(hiddenthing2);

                selectElement4 = document.querySelector('#cTerm').getAttribute("disabled");


                if (selectElement > 0) {


                    dataisValid = true;
                }
                else {

                    e.preventDefault();


                    document.getElementById('error1').innerHTML = "Please assess your course name input.";
                    document.getElementById('er1').value = 1;

                }


                if (selectElement2 > 0) {
                    

                    dataisValid = true;

                }
                else {


                    e.preventDefault();

                    document.getElementById('error2').innerHTML = "Please assess your course code input.";
                    document.getElementById('er2').value = 2;


                }

                if (selectElement4 != null) {

                    dataisValid = true;


                }
                else {
                    document.getElementById("hiddenInfo").value = "";

                    e.preventDefault();


                    document.getElementById('error4').innerHTML = "Please assess your course year input.";
                    document.getElementById('er4').value = 4;

                }


                if (dataisValid == false) {

                    alert("Errors are present in your course input submission.");

                }



                return dataisValid;












            });



        </script>

    </body>
</html>
}
